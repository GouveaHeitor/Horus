package Spellbook::Exploit::CVE-2006-3392;

use strict;
use warnings;
use Try::Tiny;
use LWP::UserAgent;

sub new {
    my ($self, $target)= @_;

    if ($target) {
        my $userAgent = LWP::UserAgent -> new();
	    my $request   = $userAgent -> get($target);
	    my $httpCode  = $request -> code();
        
        my @result = ();

        try {
            my $content = decode_json ($request -> content);
            
            foreach my $data (@$content) {
                my $username = $data -> {'slug'};
        
                push @result, "$target\n";
            }
        }
        
        catch {
            push @result, "\n";
        };

        return @result;
    }   
}

1;