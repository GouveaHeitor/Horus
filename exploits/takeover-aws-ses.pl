#!/usr/bin/env perl

use 5.010;
use strict;
use warnings;
use Try::Tiny;
use Email::MIME;
use Email::Sender::Transport::SMTP;
use Email::Sender::Simple qw(sendmail);

sub main {
    my $sender    = "";
    my $recipient = "";
    my $subject   = "AWS SeS TakeOver";

    my $smtp_username = "";
    my $smtp_password = "";
    my $smpt_host     = "";
    my $smpt_port     = 587; 

    my $htmlbody = "
        <html>
            <head>
            </head>
            <body>
                <h1>E-mail send by a Hacker</h1>
            </body>
        </html>
    ";

    my $transport = Email::Sender::Transport::SMTP->new(
        host          => $smpt_host,
        port          => $smpt_port,
        ssl           => 'starttls',
        sasl_username => $smtp_username,
        sasl_password => $smtp_password,
    );

    my $message = Email::MIME->create(
        attributes  => {
            content_type => 'multipart/alternative',
            charset      => 'UTF-8',
        },
        header_str  => [
            From    => $sender,
            To      => $recipient,
            Subject => $subject,
        ],
        parts => [
            Email::MIME -> create(
                attributes => { 
                    content_type => 'text/html'
                },
                body => $htmlbody,
            )
        ],
    );

    try {
        print "Sending e-mail...\n";
        
        sendmail($message, { 
            transport => $transport
            }
        );
    }
    catch {
        die "Error sending email: $_";
    };
}

main();
exit;

